<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FORECAST - AI Market Predictions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #000000 0%, #1a0033 25%, #000033 50%, #330000 75%, #000000 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        
        .glass-button {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1.5px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-button:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 150, 255, 0.3);
        }
        
        .glass-button:active {
            transform: translateY(0px);
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .glow-text {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5),
                         0 0 40px rgba(100, 150, 255, 0.3);
        }
        
        .signal-bullish {
            background: linear-gradient(135deg, rgba(0, 255, 100, 0.15), rgba(0, 200, 80, 0.05));
            border-color: rgba(0, 255, 100, 0.3);
        }
        
        .signal-bearish {
            background: linear-gradient(135deg, rgba(255, 50, 50, 0.15), rgba(200, 0, 0, 0.05));
            border-color: rgba(255, 50, 50, 0.3);
        }
        
        .signal-neutral {
            background: linear-gradient(135deg, rgba(150, 150, 150, 0.15), rgba(100, 100, 100, 0.05));
            border-color: rgba(150, 150, 150, 0.3);
        }
        
        input:focus {
            outline: none;
            border-color: rgba(100, 150, 255, 0.5);
            box-shadow: 0 0 20px rgba(100, 150, 255, 0.2);
        }
        
        .top-pair-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .top-pair-card:hover {
            transform: translateX(8px);
            background: rgba(255, 255, 255, 0.08);
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        
        function App() {
            const [view, setView] = useState('welcome');
            const [symbol, setSymbol] = useState('');
            const [forecast, setForecast] = useState(null);
            const [loading, setLoading] = useState(false);
            const [topPairs] = useState([
                { symbol: 'BTCUSDT', name: 'Bitcoin', change: '+2.45%' },
                { symbol: 'ETHUSDT', name: 'Ethereum', change: '+1.82%' },
                { symbol: 'BNBUSDT', name: 'BNB', change: '-0.34%' },
                { symbol: 'SOLUSDT', name: 'Solana', change: '+5.67%' },
                { symbol: 'XRPUSDT', name: 'Ripple', change: '+3.21%' },
                { symbol: 'ADAUSDT', name: 'Cardano', change: '-1.12%' },
            ]);
            
            const fetchForecast = async (sym) => {
                setLoading(true);
                try {
                    const response = await fetch(`/api/forecast?symbol=${sym}`);
                    const data = await response.json();
                    setForecast(data);
                    setView('forecast');
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to fetch forecast. Please try again.');
                } finally {
                    setLoading(false);
                }
            };
            
            const handleSearch = (e) => {
                e.preventDefault();
                if (symbol) {
                    const normalized = symbol.toUpperCase().replace(/[-_\s]/g, '');
                    const finalSymbol = normalized.endsWith('USDT') ? normalized : normalized + 'USDT';
                    fetchForecast(finalSymbol);
                }
            };
            
            const handleTopPairClick = (sym) => {
                fetchForecast(sym);
            };
            
            const getSignalEmoji = (signal) => {
                const map = { bullish: '🟢', bearish: '🔴', neutral: '⚪' };
                return map[signal] || '⚪';
            };
            
            const getSignalClass = (signal) => {
                const map = { bullish: 'signal-bullish', bearish: 'signal-bearish', neutral: 'signal-neutral' };
                return map[signal] || 'signal-neutral';
            };
            
            if (view === 'welcome') {
                return (
                    <div className="gradient-bg min-h-screen flex items-center justify-center p-4">
                        <div className="fade-in text-center">
                            <h1 className="text-8xl md:text-9xl font-black text-white glow-text mb-12 glass px-12 py-8 rounded-3xl inline-block">
                                FORECAST
                            </h1>
                            <div className="mt-16">
                                <button
                                    onClick={() => setView('main')}
                                    className="glass-button text-white text-2xl font-semibold px-16 py-6 rounded-2xl"
                                >
                                    GO
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }
            
            if (view === 'main') {
                return (
                    <div className="gradient-bg min-h-screen p-6 md:p-12">
                        <div className="max-w-6xl mx-auto">
                            <div className="slide-up mb-12">
                                <h2 className="text-5xl md:text-6xl font-black text-white glow-text mb-2">
                                    FORECAST
                                </h2>
                                <p className="text-gray-400 text-lg">AI-powered market predictions</p>
                            </div>
                            
                            <div className="slide-up mb-12" style={{ animationDelay: '0.1s' }}>
                                <form onSubmit={handleSearch} className="glass rounded-2xl p-6">
                                    <div className="flex gap-4">
                                        <input
                                            type="text"
                                            value={symbol}
                                            onChange={(e) => setSymbol(e.target.value)}
                                            placeholder="Enter symbol (e.g., BTC, ETH...)"
                                            className="flex-1 bg-transparent border border-white/20 rounded-xl px-6 py-4 text-white text-lg placeholder-gray-500"
                                        />
                                        <button
                                            type="submit"
                                            disabled={loading}
                                            className="glass-button px-8 py-4 rounded-xl text-white font-semibold text-lg"
                                        >
                                            {loading ? '...' : 'Analyze'}
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <div className="slide-up" style={{ animationDelay: '0.2s' }}>
                                <h3 className="text-2xl font-bold text-white mb-6">Top Trading Pairs</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {topPairs.map((pair, idx) => (
                                        <div
                                            key={pair.symbol}
                                            onClick={() => handleTopPairClick(pair.symbol)}
                                            className="glass top-pair-card rounded-xl p-6 flex justify-between items-center"
                                        >
                                            <div>
                                                <div className="text-white font-bold text-xl mb-1">
                                                    {pair.name}
                                                </div>
                                                <div className="text-gray-400 text-sm">
                                                    {pair.symbol}
                                                </div>
                                            </div>
                                            <div className={`text-lg font-semibold ${
                                                pair.change.startsWith('+') ? 'text-green-400' : 'text-red-400'
                                            }`}>
                                                {pair.change}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }
            
            if (view === 'forecast' && forecast) {
                return (
                    <div className="gradient-bg min-h-screen p-6 md:p-12">
                        <div className="max-w-4xl mx-auto">
                            <button
                                onClick={() => setView('main')}
                                className="glass-button px-6 py-3 rounded-xl text-white mb-8"
                            >
                                ← Back
                            </button>
                            
                            <div className="fade-in mb-8">
                                <div className="glass rounded-2xl p-8">
                                    <div className="flex items-center justify-between mb-4">
                                        <h2 className="text-4xl font-black text-white">
                                            {forecast.symbol}
                                        </h2>
                                        <div className={`glass ${getSignalClass(forecast.signal)} px-6 py-3 rounded-xl`}>
                                            <span className="text-2xl mr-2">{getSignalEmoji(forecast.signal)}</span>
                                            <span className="text-white font-bold text-xl uppercase">
                                                {forecast.signal}
                                            </span>
                                        </div>
                                    </div>
                                    <div className="text-5xl font-black text-white glow-text mb-2">
                                        ${forecast.price.toLocaleString()}
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <div className="text-gray-400">Confidence:</div>
                                        <div className="flex-1 bg-white/10 rounded-full h-3 overflow-hidden">
                                            <div
                                                className="h-full bg-gradient-to-r from-blue-500 to-purple-500"
                                                style={{ width: `${forecast.confidence * 100}%` }}
                                            />
                                        </div>
                                        <div className="text-white font-bold">
                                            {(forecast.confidence * 100).toFixed(0)}%
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                <div className="fade-in glass rounded-2xl p-6" style={{ animationDelay: '0.1s' }}>
                                    <div className="text-gray-400 text-sm mb-2">EMA Analysis</div>
                                    <div className="text-white font-bold text-xl mb-3">
                                        {forecast.analysis.ema.trend}
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        EMA9: ${forecast.analysis.ema.ema9.toFixed(2)}
                                        <br />
                                        EMA21: ${forecast.analysis.ema.ema21.toFixed(2)}
                                    </div>
                                </div>
                                
                                <div className="fade-in glass rounded-2xl p-6" style={{ animationDelay: '0.2s' }}>
                                    <div className="text-gray-400 text-sm mb-2">Bollinger Bands</div>
                                    <div className="text-white font-bold text-xl mb-3">
                                        {forecast.analysis.bollinger.signal}
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        Position: {(forecast.analysis.bollinger.position * 100).toFixed(1)}%
                                    </div>
                                </div>
                                
                                <div className="fade-in glass rounded-2xl p-6" style={{ animationDelay: '0.3s' }}>
                                    <div className="text-gray-400 text-sm mb-2">Fibonacci</div>
                                    <div className="text-white font-bold text-xl mb-3">
                                        {forecast.analysis.fibonacci.currentLevel}
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        Signal: {forecast.analysis.fibonacci.signal}
                                    </div>
                                </div>
                                
                                <div className="fade-in glass rounded-2xl p-6" style={{ animationDelay: '0.4s' }}>
                                    <div className="text-gray-400 text-sm mb-2">Funding Rate</div>
                                    <div className="text-white font-bold text-xl mb-3">
                                        {(forecast.analysis.fundingRate * 100).toFixed(3)}%
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        {forecast.analysis.fundingRate > 0 ? 'Bullish sentiment' : 'Bearish sentiment'}
                                    </div>
                                </div>
                            </div>
                            
                            <div className="fade-in glass rounded-2xl p-8" style={{ animationDelay: '0.5s' }}>
                                <div className="text-gray-400 text-sm mb-2">🧠 AI Analysis</div>
                                <div className="text-white font-bold text-xl mb-4">
                                    {forecast.analysis.ml.reasoning}
                                </div>
                                <div className="glass rounded-xl p-6 bg-white/5">
                                    <div className="text-gray-400 text-sm mb-2">💡 Recommendation</div>
                                    <div className="text-white text-lg font-semibold">
                                        {forecast.recommendation}
                                    </div>
                                </div>
                            </div>
                            
                            <div className="mt-8 text-center text-gray-500 text-sm">
                                ⚠️ This is not financial advice. Always do your own research.
                            </div>
                        </div>
                    </div>
                );
            }
            
            return null;
        }
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>